# 5 SQLAlchemy
## 5.1 ORM
**ORM全称 Object Relational Mapping对象关系映射**

通过 ORM 可以不用关心后台是使用的哪种数据库，只需要按照 ORM 所提供的语法规则去书写相应的代码， ORM 就会自动的转换成对应对应数据库的 SQL 语句

## 5.2 SQLAIchemy连接数据库
### 5.2.1 安装
#### 5.2.1.1 安装mysql
Mysql安装教程连接:
#### 5.2.1.2 安装python包`pymysql`、`sqlalchemy`
1. pymysql安装:`pip install pymysql`
2. sqlalchemy安装:`pip install sqlalchemy`

#### 5.2.2 导入create_engine模块
db.py代码
```
from sqlalchemy import create_engine
```

#### 5.2.3  数据库连接配置

```
HOSTNAME = '127.0.0.1'
PORT = '3306'
DATABASE = 'mysql'
USERNAME = 'leva'
PASSWORD = 'leva123'
```

#### 5.2.4 数据库连接URL
```
# 第一种数据库连接
DB_url = 'mysql+pymysql://%s:%s@%s:%s/%s?charset=utf8' %(
    USERNAME,
    PASSWORD,
    HOSTNAME,
    PORT,
    DATABASE
)

# 第二种数据库连接 
DB_url = 'mysql+pymysql://{}:{}@{}:{}/{}?charset=utf8'.format(
    USERNAME,
    PASSWORD,
    HOSTNAME,
    PORT,
    DATABASE
)
```

#### 5.2.5 数据库连接
```
engine = create_engine(DB_url)
```

#### 5.2.6 测试数据库
```
if __name__== '__main__':
    connection = engine.connect()
    result = connection.execute('select 1')
    print(result)
```
#### 5.2.7 创建一个基类
```
from sqlalchemy import create_engine #create_engine模块
from sqlalchemy.ext.declarative import declarative_base #导入一个基类模块

HOSTNAME = '127.0.0.1'
PORT = '3306'
DATABASE = 'mydb'
USERNAME = 'leva'
PASSWORD = 'leva123'

DB_url = 'mysql+pymysql://{}:{}@{}:{}/{}?charset=utf8'.format(
    USERNAME,
    PASSWORD,
    HOSTNAME,
    PORT,
    DATABASE
)

engine = create_engine(DB_url)

Base = declarative_base(engine) # 这个Base类就是基类
```
## 5.3 Module
**通过SQLALchemy提供的语法来声明表**
1. __tablename__: 数据库中表名
2. Column: 用来创建表中的字段的一个方法
3. Integer: 整型，映射到数据库中的类型
4. String: 字符类型，映射到数据库中的类型，使用时，需要提供一个字符长度
5. DateTime:  时间类型

### 5.3.1 创建数据库模型
user_modules.py代码
```
from connect import Base
from datetime import datetime
from sqlalchemy import Column, Integer, String, Boolean, DateTime


``` 
## 5.4 增删改查
## 5.5 查询结果
## 5.6 条件查询
## 5.7 多表查询
## 5.8 原生sql查询
## 5.9 一对一表关系
## 5.10 多对多表关系
## 5.11 包管理
## 5.12 简单的登录