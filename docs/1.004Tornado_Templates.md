# 4 Templates
模板就是html文件，只是其中加入了模板语法，需要服务器的渲染，才能正常显示数据
## 4.1 模板
1. 之前我们通过render可以返回一个html页面，不过那都是固定的页面，固定的数据，但是如果数据是不确定的，是会不断改变的，该怎么做呢？
2. 是否可以先把页面写好，然后预留出固定的位置，在需要的时候再填入数据即可？

### 4.1.1 配置路径
在 application 中配置模板文件和静态文件的路径：
```
app = tornado.web.Application(
    template_path = 'templates', # 配置路径
)
```

### 4.1.2 HTML模板
```
class LoginHandler(tornado.web.RequestHandler):
    def get(self):
        self.render('login.html')

app = tornado.web.Application(
    handlers = [
        (r'/login',LoginHandler),
    ],
    template_path = 'templates',
)
```
## 4.2 模板语法
既然有了模板，那模板的语法规则是怎样的呢？
### 4.2.1 模板符号
`{{ expression }}`用 {{ expression }} 中间是任何 python 表达式，或者是一个变量
示例
```
{{ 1 + 1 }}
{{ time.time() }}
```

`{%  directives %}`其他的模板指令
示例
```
{% if 1 %}     this is if {% end %}
```

`{#  … #}`在模板中要注释python表达式的运行，需要使用这个模板语法
示例
```
{# time.time()#}
```

`{{!   {%!   {#!`如果不想执行内容，需要在页面上打印出模板符号，只需要加上感叹号( ! )即可
示例
```
{{! 1 + 1}}

{%! if 1 %}     this is if {%! end %}

{#! time.time() #}}
```

### 4.2.2 控制语句 if判断

在模板中可以使用 if 判断

注意：最后需要以 {% end %} 结尾

示例
```
{% if username != 'no' %}     

欢迎{{ username }}登录 

{% else %}     请登录 

{% end %}
```
### 4.2.3 循环语句 for and while
#### 4.2.3.1 for循环
在 tornado 模板中可以使用 for 循环

注意：最后需要以 {% end %} 结尾
```
{% for i in urllist %}     

{{ i }} 

{% end %}
```
#### 4.2.3.2 while循环
在 tornado 模板中可以使用 while 循环

注意：最后需要以 {% end %} 结尾
```
{% set a = 0 %}  

{% while a<5 %}     

{{ a }} <br>     

{% set a += 1 %} 

{% end %}
```

### 4.2.4 模板语法总结
1. `{{ … }}`:此符号中放入任意 python 表达式，或者模板中的变量
2. `{% … %} {% end %}`:此符号中放入模板中的命令，比如`if 、for`和`while`等需要注意的是，使用`if`等命令是，需要加上`{% end%}`除此之外，异常处理`try`也可以在模板中使用，但是这样做会让模板变得像 python 模块一样，因此并不建议大家这么做
3. `{# #}`:模板中的注释语句，可以让模板中指令不执行

### 4.2.5 模板符号总结
1. 必须掌握:`{{、{%、{#`三个符号的作用
2. 必须掌握:`{% if %} … {% end %}`的用法
3. 必须掌握:`{% for … %} … {% end %}{% while … %} … {% end %}`的用法

## 4.3 模板转义
通过模板，可以把数据动态的添加到页面，如果添加的值是一段html代码的话，会不会被执行呢？

### 4.3.1 参数
`atga = "<a href='https://www.baidu.com' target='_blank'>___百度___</a><br>"`

### 4.3.2 模板
`{{ atga }}`

### 4.3.3 转义
* 页面并没有解析，只是当作一个字符串，直接在页面上打印出来
* tornado默认是自动的转义，传入的数据都会当作字符串，不会被浏览器解析

#### 4.3.3.1 局部去掉转义
`{% raw atga %}`

#### 4.3.3.2 raw
raw 可以自模板中去掉转义，让 tornado 在渲染的时候不去转义变量

### 4.3.4 模板去掉转义
#### 4.3.4.1 模板去转义
`{% autoescape None %}`

#### 4.3.4.2 autoescape
在模板中添加上面代码之后，当前模板不再转义

#### 4.3.4.3 escape
`{{ escape(atga) }}`
在开启模板不转义之后，可以使用 escape 来添加转义

#### 4.3.4.4 全局去掉转义
在 Application 中添加如下配置：
`autoescape=None,`

`autoescape`去掉整个项目的转义，配置之后，整个项目中的模板不再转义


## 4.4 静态文件引用
## 4.5 模板继承
## 4.6 函数和类导入
## 4.7 un_methodes和ui_modules
## 4.8 模板其他